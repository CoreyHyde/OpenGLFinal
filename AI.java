package finalProject;

import javax.media.opengl.GL2;

class AI {
	private Car ai = null;
	private float CAR_SPEED = 0.33f;
	public float ai_x = 0;
	public float ai_y = 0;
	private float ai_prev_x = 0;
	private float ai_prev_y = 0;
	private double theta = 0;
	private int index = 2;
	private float deltX = 0.1f;
	float ai_points[] = null;
	
	public AI(TextureLoader texture_loader, int i) {
		ai = new Car( texture_loader );
		switch(i) {
			case 1: ai_points = ai1_points; break;
			case 2: ai_points = ai2_points; break;
			case 3: ai_points = ai3_points; break;
		}
		ai_x = ai_points[0];
		ai_y = ai_points[1];
		ai_prev_x = ai_x - 10;
		ai_prev_y = ai_y;
	}
	
	public void moveAI( GL2 gl ) {
		gl.glPushMatrix();
		float varSpeed = (float) (Math.random() * 0.09 + 0.24);
		ai.moveTo(gl, ai_x, ai_y, ai_prev_x, ai_prev_y, theta);

		float m = (ai_points[index-1] - ai_points[index+1]) / (ai_points[index-2] - ai_points[index]);
		
		theta = Math.atan2((ai_points[index+1] - ai_points[index-1]), (ai_points[index] - ai_points[index-2]));
		
		deltX = varSpeed * (float)Math.cos(theta);

		ai_prev_y = ai_y;
		ai_prev_x = ai_x;

		ai_x += deltX;
		ai_y = line(ai_x, m, ai_prev_x, ai_prev_y);

		if(ai_prev_x > ai_points[index]-CAR_SPEED*2 && ai_prev_x < ai_points[index]+CAR_SPEED*2 && ai_prev_y > ai_points[index+1]-CAR_SPEED*2 && ai_prev_y < ai_points[index+1]+CAR_SPEED*2) {
			index += 2;

			if(ai_x < ai_prev_x)
				deltX = -1 * Math.abs(deltX); 
			else if (ai_x > ai_prev_x)
				deltX = Math.abs(deltX);
		}
		if(index == ai_points.length-2) index = 2;
		gl.glPopMatrix();
	}
	
	public float line(float x, float m, float pX, float pY) {
		return m*(x - pX) + pY;
	}
	
	public void render( GL2 gl ) {
		gl.glPushMatrix();
			gl.glTranslated(ai_x, ai_y, -.025f);
			gl.glRotatef(90f, 1f, 0f, 0f);
			gl.glPushMatrix();
			gl.glRotatef((float)(theta * 180/Math.PI)+90, 0f, 1f, 0f);
			ai.drawCar(gl);
			gl.glPopMatrix();
		gl.glPopMatrix();
	}
	
	private float[] ai1_points = {
			-5.0f, -60.0f,
			-4.995f, -60.0f,
			-3.7949998f, -60.0f,
			-1.6149998f, -60.0f,
			2.735f, -60.0f,
			11.510001f, -60.0f,
			20.560003f, -60.0f,
			29.710012f, -60.0f,
			38.55502f, -60.0f,
			47.058434f, -59.86055f,
			54.836174f, -59.673542f,
			64.25264f, -58.895134f,
			71.22516f, -55.406693f,
			74.93367f, -48.820976f,
			76.03729f, -39.55142f,
			75.78405f, -30.100805f,
			74.05365f, -21.123533f,
			71.78881f, -11.946021f,
			67.19604f, -4.1377177f,
			60.040604f, 1.5423329f,
			52.951916f, 7.325168f,
			46.508118f, 13.813706f,
			39.928535f, 20.598999f,
			33.678375f, 27.277617f,
			27.631035f, 34.11028f,
			21.735298f, 40.060993f,
			17.353355f, 43.684433f,
			12.24014f, 45.403355f,
			8.23577f, 46.283703f,
			6.349584f, 46.61402f,
			4.4913087f, 46.930298f,
			-0.77297866f, 47.82632f,
			-6.5279016f, 48.845486f,
			-11.459366f, 50.123363f,
			-16.253794f, 51.432686f,
			-23.840952f, 53.504692f,
			-32.374493f, 55.638596f,
			-40.372154f, 55.771626f,
			-45.32637f, 52.9321f,
			-46.644295f, 50.159157f,
			-46.261612f, 47.8998f,
			-45.15572f, 46.14363f,
			-43.314533f, 43.557007f,
			-39.06623f, 37.708206f,
			-34.324093f, 32.257534f,
			-28.944223f, 28.247425f,
			-22.534979f, 25.612883f,
			-16.515873f, 23.17252f,
			-10.71919f, 20.822329f,
			-4.069915f, 18.126453f,
			3.3913586f, 14.944658f,
			8.558231f, 9.891512f,
			10.378411f, 3.6461115f,
			8.854727f, -1.3100007f,
			6.1506686f, -4.2127748f,
			1.2265809f, -8.422115f,
			-4.780572f, -10.299408f,
			-10.396169f, -10.766468f,
			-15.716777f, -11.143279f,
			-21.036745f, -11.159158f,
			-25.85173f, -11.170747f,
			-29.391724f, -11.179266f,
			-34.266712f, -11.190999f,
			-42.910244f, -11.296967f,
			-51.414776f, -11.696586f,
			-59.89472f, -12.718095f,
			-68.80261f, -14.936386f,
			-75.652405f, -20.56804f,
			-79.08183f, -28.815233f,
			-77.91619f, -36.576714f,
			-72.32687f, -43.58182f,
			-64.57785f, -47.527916f,
			-56.385315f, -49.677525f,
			-47.791252f, -49.849842f,
			-39.69352f, -51.59847f,
			-33.961155f, -55.742283f,
			-28.878784f, -58.769726f,
			-23.695335f, -59.843674f,
			-20.615341f, -60.018944f,
			-19.377234f, -60.08734f,
			-5.0f, -60.0f,
			-4.995f, -60.0f};
	
	private float[] ai2_points = {
			0.0f, -63.0f,
			0.005f, -63.0f,
			1.745f, -63.0f,
			4.554999f, -63.0f,
			7.2199984f, -63.0f,
			11.774999f, -63.0f,
			18.989998f, -63.0f,
			27.88453f, -63.04586f,
			35.132427f, -63.220108f,
			42.99827f, -63.742718f,
			49.605408f, -63.634518f,
			54.318966f, -63.092945f,
			58.439182f, -62.05525f,
			62.113033f, -60.14688f,
			66.30338f, -57.116264f,
			68.85669f, -53.0634f,
			71.33446f, -47.740234f,
			73.22297f, -41.72275f,
			74.76668f, -35.66184f,
			76.3402f, -28.74866f,
			77.88371f, -20.959259f,
			78.82492f, -13.2877f,
			79.49446f, -5.783451f,
			80.02976f, 2.0528345f,
			80.31504f, 9.402296f,
			80.37532f, 17.555408f,
			80.303f, 25.40507f,
			80.232956f, 33.009743f,
			80.16231f, 40.679432f,
			80.097855f, 47.684147f,
			79.8812f, 53.35274f,
			79.28832f, 56.506527f,
			77.84383f, 58.30751f,
			74.930435f, 60.707108f,
			71.534294f, 61.924316f,
			65.575f, 62.709774f,
			57.911514f, 63.02523f,
			49.04861f, 63.103992f,
			39.60884f, 63.034092f,
			30.204836f, 62.92051f,
			21.20275f, 62.712143f,
			11.748022f, 62.642136f,
			3.3432555f, 62.57968f,
			-3.7426808f, 62.233498f,
			-12.654898f, 61.391872f,
			-21.433153f, 59.92455f,
			-29.879417f, 58.203457f,
			-38.085846f, 55.84218f,
			-44.040264f, 51.42807f,
			-45.587734f, 46.653435f,
			-44.990906f, 43.651688f,
			-43.50402f, 42.64669f,
			-39.482887f, 40.517673f,
			-35.474438f, 37.295444f,
			-31.921532f, 32.75762f,
			-27.354933f, 28.07461f,
			-20.832777f, 25.478348f,
			-13.186031f, 25.671621f,
			-4.9557805f, 25.738646f,
			3.6614594f, 24.091171f,
			10.923039f, 19.144196f,
			15.166726f, 12.162634f,
			17.176672f, 3.4581656f,
			16.911936f, -4.478133f,
			12.620285f, -11.067848f,
			4.940643f, -15.428052f,
			-3.51787f, -17.06728f,
			-12.479171f, -15.963304f,
			-21.610216f, -15.071437f,
			-30.483128f, -14.608637f,
			-39.30141f, -14.153261f,
			-47.701927f, -13.898951f,
			-56.101444f, -14.306692f,
			-64.12924f, -15.638392f,
			-71.13559f, -18.348488f,
			-75.14874f, -23.692327f,
			-76.19921f, -29.623354f,
			-75.42927f, -34.330948f,
			-72.7557f, -37.615494f,
			-69.486435f, -39.566235f,
			-63.889854f, -41.33176f,
			-55.19629f, -42.32378f,
			-47.012703f, -43.819958f,
			-39.97026f, -48.141994f,
			-35.706875f, -53.378117f,
			-32.92521f, -55.574f,
			-28.33537f, -58.08865f,
			-24.024809f, -60.107f,
			-19.69577f, -61.135597f,
			-14.698432f, -61.89695f,
			-9.526207f, -62.514553f,
			-4.5261526f, -62.875675f,
			0.0f, -63.0f,
			0.005f, -63.0f};
	
	private float[] ai3_points = {
			5.0f, -66.0f,
			5.005f, -66.0f,
			5.6000004f, -66.0f,
			10.404094f, -66.05315f,
			16.879805f, -66.471954f,
			26.00575f, -67.12705f,
			35.112766f, -67.82648f,
			44.518883f, -68.6092f,
			53.073093f, -68.42354f,
			61.288197f, -65.09689f,
			69.547104f, -61.727226f,
			74.77677f, -56.15079f,
			78.81315f, -48.226032f,
			79.85779f, -38.9189f,
			80.98899f, -29.84254f,
			81.52305f, -20.411661f,
			84.798706f, -11.902045f,
			88.19475f, -3.084979f,
			89.04142f, 4.5730305f,
			88.58551f, 12.975671f,
			88.13449f, 21.28844f,
			87.767204f, 28.193644f,
			87.78924f, 34.22824f,
			87.83533f, 39.468025f,
			87.88006f, 44.55282f,
			87.931656f, 50.41758f,
			87.809135f, 55.44233f,
			87.07705f, 59.305138f,
			85.97358f, 61.865147f,
			83.85105f, 64.471596f,
			81.12045f, 67.195404f,
			78.273186f, 68.98753f,
			75.045204f, 69.520744f,
			70.80887f, 70.09437f,
			66.32314f, 70.552925f,
			62.223373f, 70.74892f,
			54.971684f, 70.96792f,
			46.156986f, 71.03448f,
			36.77721f, 71.096405f,
			28.112404f, 71.15356f,
			19.072603f, 71.21317f,
			10.692785f, 71.268425f,
			2.6687932f, 71.25446f,
			-4.4422307f, 70.81625f,
			-10.984645f, 68.55597f,
			-16.604013f, 65.54591f,
			-21.65685f, 63.79576f,
			-26.061937f, 62.82442f,
			-31.553442f, 62.09303f,
			-40.127235f, 60.796448f,
			-47.615387f, 57.670254f,
			-51.474533f, 52.857376f,
			-51.996113f, 49.861347f,
			-51.43117f, 47.876488f,
			-50.82123f, 45.903614f,
			-48.942436f, 41.404606f,
			-46.095222f, 37.852337f,
			-43.256657f, 36.468178f,
			-40.010372f, 34.834858f,
			-37.83871f, 32.650803f,
			-36.38472f, 29.839605f,
			-33.310207f, 24.06386f,
			-29.581335f, 20.677496f,
			-24.39369f, 18.820276f,
			-19.309635f, 17.904203f,
			-14.429714f, 17.930147f,
			-9.60479f, 17.956594f,
			-5.2289014f, 17.65175f,
			-0.10709222f, 16.725468f,
			4.0547404f, 20.103811f,
			8.775256f, 16.204138f,
			12.349992f, 11.9290695f,
			15.152307f, 4.5756154f,
			14.184204f, -3.658032f,
			9.612987f, -11.2100525f,
			1.8259774f, -15.5193f,
			-7.1111813f, -15.558152f,
			-14.983559f, -13.842435f,
			-23.43027f, -12.517486f,
			-32.012806f, -11.187914f,
			-39.9869f, -10.326547f,
			-47.970806f, -9.905493f,
			-56.71646f, -10.006268f,
			-65.307365f, -11.434843f,
			-72.7022f, -16.34701f,
			-76.96479f, -23.199522f,
			-80.29364f, -31.67258f,
			-78.823456f, -39.85019f,
			-73.748375f, -45.006363f,
			-67.69999f, -46.51375f,
			-61.73518f, -46.862682f,
			-55.350986f, -47.23457f,
			-48.871716f, -47.94478f,
			-42.711575f, -49.51899f,
			-36.894955f, -54.21278f,
			-31.038448f, -61.04261f,
			-23.610306f, -64.62841f,
			-18.817863f, -64.97552f,
			-15.360354f, -65.18662f,
			-11.209314f, -65.63327f,
			-6.7097588f, -66.06188f,
			5.0f, -66.0f,
			5.005f, -66.0f};
}